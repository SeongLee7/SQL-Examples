-- This SQL code contains various queries focused on retrieving data from customers, items, orders, and order_details tables.

--1 Fetching the first 10 customers bu last name in ascending order
SELECT CUSTOMER_LAST_NAME, CUSTOMER_FIRST_NAME
FROM OM.customers
ORDER BY CUSTOMER_LAST_NAME ASC
FETCH NEXT 10 ROWS ONLY;

--2 Fetch the first 10 customers by their last name in descending order 
SELECT CUSTOMER_LAST_NAME, CUSTOMER_FIRST_NAME
FROM OM.customers
ORDER BY CUSTOMER_LAST_NAME DESC
FETCH NEXT 10 ROWS ONLY;

--3 Fetch the first 10 customers by last name ascending, first name descending
SELECT CUSTOMER_LAST_NAME, CUSTOMER_FIRST_NAME
FROM OM.customers
ORDER BY CUSTOMER_LAST_NAME ASC, CUSTOMER_FIRST_NAME DESC
FETCH NEXT 10 ROWS ONLY;

--4 Fetch the first 10 customers ordered by last name descending
SELECT CUSTOMER_LAST_NAME, CUSTOMER_FIRST_NAME
FROM OM.customers
ORDER BY 1 DESC
FETCH NEXT 10 ROWS ONLY;

--5 Select and alias customer data
SELECT CUSTOMER_FIRST_NAME AS FIRSTNAME,
CUSTOMER_LAST_NAME AS "Last Name",
CUSTOMER_CITY AS "'city'", 
CUSTOMER_STATE AS "*Cust-State*"
FROM OM.customers;

--6 Select distinct customer states
SELECT
DISTINCT CUSTOMER_STATE
FROM OM.customers
GROUP BY CUSTOMER_STATE
ORDER BY CUSTOMER_STATE ASC;

--7 Select distinct customer faxes
SELECT
DISTINCT CUSTOMER_FAX
FROM OM.customers
GROUP BY CUSTOMER_FAX
ORDER BY CUSTOMER_FAX DESC;

--8 fetch the first 4 rows from OM.customers
SELECT *
FROM OM.customers
FETCH FIRST 4 ROWS ONLY;

--9 Select items where the title contains 'road'
SELECT TITLE
FROM OM.ITEMS
WHERE TITLE LIKE '%Road%'; 

--10 Select items with decimal unit price
SELECT TITLE, UNIT_PRICE
FROM OM.ITEMS
WHERE unit_price LIKE '%.%'
ORDER BY UNIT_PRICE DESC;

--11 Selec itmes without a decimal in unit price
SELECT TITLE, UNIT_PRICE
FROM OM.ITEMS
WHERE UNIT_PRICE NOT LIKE '%.%'
ORDER BY TITLE DESC;

--12 Select orders with quantity greater than or equal to 2
SELECT ORDER_ID, ORDER_QTY
FROM OM.ORDER_DETAILS
WHERE ORDER_QTY >= 2
ORDER BY ORDER_ID ASC;

--13 Select orders where order id is divisible by 13
SELECT ORDER_ID
FROM OM.ORDER_DETAILS
WHERE MOD(order_id,13)=0
ORDER BY ORDER_ID ASC;

--14 Select orders where shipped date is NULL
SELECT ORDER_ID,SHIPPED_DATE
FROM OM.orders
WHERE SHIPPED_DATE IS null;

--15 Select orders taking more than 25 days to ship
SELECT ORDER_ID, (SHIPPED_DATE - ORDER_DATE) AS "Number of days to ship"
FROM OM.ORDERS
WHERE SHIPPED_DATE - ORDER_DATE > 25
ORDER BY SHIPPED_DATE - ORDER_DATE DESC;